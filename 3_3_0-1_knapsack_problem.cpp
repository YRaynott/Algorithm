#include <iostream>
#include <algorithm>
using namespace std;

//items用來記錄有沒有拿,c則是紀錄目前重量 
int items[8000][200], c[8000][200];

int main(){
	int w, n, i, j;
	int g[8000] = {0}, v[8000] = {0};
	cin >> w;
	while(cin >> i)//i為輸入代號,n表物品總數,g[]存放重量,v[]存放價值 
	{
		if(i != -1)
		{
			n = i;
			cin >> g[i] >> v[i];
		}
	}
	c[0][0] = 0;
	for(i = 0; i <= n; i++)
	{
		for(j = 0; j <= w; j++)
		{
			items[i][j] = 0;
		}
	}
	for(i = 0; i < n; i++)
	{
		for(j = 0; j <= w; j++)
		{
			if(j - g[i] < 0)
			{
				c[i+1][j] = c[i][j];
			}
			else
			{
				c[i+1][j] = max(c[i][j-g[i]] + v[i], c[i][j]);
				if(c[i][j-g[i]] + v[i] > c[i][j])
				{
					items[i][j] = 1;
				}
			}
		}
	}
	for(i = n, j = w; i >= 0; i--)
	{
		if(items[i][j] == 1)
		{
			cout << i << " ";
			j -= g[i];
		}
	}
	cout << endl << c[n][w] << endl;
	return 0;
}

/*
背包重量
代號 重量 價值 
100
0 10 8
1 25 25
2 65 75
3 25 29
4 25 17
5 15 20
-1 -1 -1
->
3 2 0 
112

191
1 30 42200
2 48 35692
3 30 40513
4 38 28322
5 30 40799
6 45 16734
7 39 15732
8 42 12050
9 44 31183
10 30 20119
11 46 17944
12 45 27633
13 32 42327
14 41 34768
15 36 19859
16 36 41386
17 39 14167
18 33 26510
19 43 24456
20 43 13047
21 40 30026
22 43 23618
23 49 37095
24 44 30372
25 43 12790
26 43 33956
27 42 29239
28 43 14731
29 46 26583
30 48 30284
31 39 27937
32 42 28875
33 33 15560
34 43 27281
35 45 22848
36 33 38987
37 48 23282
38 32 28070
39 34 21544
40 32 31086
41 46 19193
42 49 27634
43 34 10420
44 32 22039
45 40 15205
46 36 14767
47 41 20883
48 35 13279
49 43 24910
50 48 28869
51 35 25365
52 35 17301
53 39 24139
54 35 16616
55 48 26673
56 45 41206
57 33 22428
58 49 36335
59 37 32474
60 43 26285
61 38 10901
62 32 30839
63 35 16260
-1 -1 -1
->
36 16 13 5 3 1 
246212
*/
